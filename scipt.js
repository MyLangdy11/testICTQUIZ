
var questions = [
  {
        question: "អ្វីទៅជាកុំព្យូទ័រ?",
        options: ["កុំព្យូទ័រគឺជាម៉ាស៊ីនអេឡិចត្រូនិកដែលអាចបោះពុម្ពបាន និងអាចចាក់វីដេអូ រូបភាពជាដើម។","កុំព្យូទ័រគឺជាម៉ាស៊ីនដែលត្រូវការKeyboard Mouseដើម្បីដំណើរការ។","កុំព្យូទ័រគឺជាម៉ាស៊ីនអេឡិចត្រូនិក ដែលអាចបងញ្ចូល គណនា រក្សាទុកទិន្នន័យ(ឯកសារ) និងបញ្ចេញព័ត៌មានមកក្រៅវិញ។","កុំព្យូទ័រគឺជាម៉ាស៊ីនដែលមានសារសំខាន់ជាងគេក្នុងជីវិត្តរស់នៅ។"],
        answer: 2,
        explanation: "កុំព្យូទ័រគឺជាម៉ាស៊ីនអេឡិចត្រូនិក ដែលអាចបងញ្ចូល គណនា រក្សាទុកទិន្នន័យ(ឯកសារ) និងបញ្ចេញព័ត៌មានមកក្រៅវិញ។ វាជាឧបករណ៍អេឡិចត្រូនិកសម្រាប់ធ្វើការជាមួយព័ត៌មាន។ អ្នកអាចប្រើកុំព្យូទ័រសម្រាប់បង្កើតឯកសារ ដូចជា សរសេរសំបុត្រ គូរគំនូរ គណនា សរសេរកូដកម្មវិធី ឌីហ្សាញផ្សេងៗ។ល។"
      },
    {
        question: "តើសមាសភាគសំខាន់ៗរបស់កុំព្យូទ័រមានប៉ុន្មាន?",
        options: ["២","៣","៤","៦"],
        answer: 2,
        explanation: "កុំព្យូទ័រផ្សំឡើងដោយសមាសភាគសំខាន់៤គឺ៖ ១.ធុងប្រព័ន្ធ(System Unit), ២.ម៉ូនីទ័រ(Monitor), ៣.ក្ដារចុច(Keyboard), ៤.កណ្ដុរ(Mouse)។"
      },
    {
        question: "ក្នុងចំណោមចម្លើយខាងក្រោម មួយណាដែលជាមុខងាររបស់ធុងប្រព័ន្ធ (System Unit)?",
        options: ["បង្ហាញព័ត៌មានផ្សេងៗ ដែលកំពុងដំណើរការក្នុងកុំព្យូទ័រ","ជាឧបករណ៍បញ្ចូលទិន្នន័យ","ជាធុងដែលផ្ទុកនូវសមាសភាគសំខាន់ៗសម្រាប់ឱ្យប្រព័ន្ធដំណើរការបាន","ជាឧបករណ៍អនុញ្ញាត្តឱ្យយើងបញ្ជាព្រួញកណ្ដុរបាន"],
        answer: 2,
        explanation: "ធុងប្រព័ន្ធ គឺជាធុងមួយដែលផ្ទុកនូវសមាសភាគសំខាន់ៗសម្រាប់ឱ្យប្រព័ន្ធកុំព្យូទ័រដំណើរការបាន។ សមាសភាគទាំងនោះមានដូចជា បន្ទះមេ(Motherboard) ខួរក្បាល(CPU) ថាសរឹង(Hard Drive) សតិ(RAM) កាតបន្ថែម(Expansion Card) ដ្រាយស៊ីឌីរ៉ូម(CD-ROM Drive)។ល។ សមាសភាគនេះវាដូចជាខួរក្បាលរបស់មនុស្ស ដែលមានតួនាទីយ៉ាងសំខាន់ក្នុងការគិត និងធ្វើឱ្យប្រព័ន្ធទាំងមូលដំណើរការបាន។"
      },
    {
        question: "ក្នុងចំណោមចម្លើយខាងក្រោម មួយណាដែលជាតួរនាទីរបស់កណ្ដុរ(Mouse)?",
        options: ["បង្ហាញព័ត៌មានផ្សេងៗ ដែលកំពុងដំណើរការក្នុងកុំព្យូទ័រ","ជាឧបករណ៍បញ្ចូលទិន្នន័យ","ជាធុងដែលផ្ទុកនូវសមាសភាគសំខាន់ៗសម្រាប់ឱ្យប្រព័ន្ធដំណើរការបាន","ជាឧបករណ៍កាន់ដោយដៃ ដែលអនុញ្ញាតឱ្យយើងបញ្ជាព្រួញកណ្ដុរ ដែលស្ថិតលើអេក្រង់ ដើម្បីជ្រើសរើសរូបតំណាង ឬជ្រើសម៉ឺនុយណាមួយ។"],
        answer: 3,
        explanation: "កណ្ដុរ(Mouse) ជាឧបករណ៍កាន់ដោយដៃ ដែលអនុញ្ញាតឱ្យយើងបញ្ជាព្រួញកណ្ដុរ ដែលស្ថិតលើអេក្រង់ ដើម្បីជ្រើសរើសរូបតំណាង ឬជ្រើសម៉ឺនុយណាមួយ។ វាត្រូវបានប្រើដោយភ្ជាប់ទៅនឹងធុងប្រព័ន្ធតាមរយៈច្រក(Port) PS/2 ឬUSB។"
      },
    {
        question: "ក្នុងចំណោមចម្លើយខាងក្រោម ចម្លើយមួយណាដែលជាមុខងាររបស់ម៉ូនីទ័រ(Monitor)?",
        options: ["ជាឧបករណ៍បញ្ចូលទិន្នន័យ","ជាឧបករណ៍បង្ហាញព័ត៌មានដែលកំពុងដំណើរការក្នុងកុំព្យូទ័រ រាងដូចទូរទស្សន៍","ជាឧបករណ៍បញ្ជារព្រួញកណ្ដុរ","ជាឧបការផ្ទុក ដូចនឹងខួរក្បាលមនុស្ស"],
        answer: 1,
        explanation: "ម៉ូនីទ័រ(Monitor) គឺជាឧបករណ៍មានរាងដូចទូរទស្សន៍ដែលមាននាទីសម្រាប់បង្ហាញព័ត៌មានផ្សេងៗ ដែលកំពុងដំណើរការលើកុំព្យូទ័រ។ វាត្រូវបានគេប្រើដោយភ្ជាប់ជាមួយនឹងធុងប្រព័ន្ធតាមរយៈច្រក(Port) VGA។"
      },
    
  // {
  //   question: "",
  //   options: ["","","",""],
  //   answer: 0,
  //   explanation: ""
  // },
  // {
  //   question: "",
  //   options: ["","","",""],
  //   answer: 0,
  //   explanation: ""
  // },
   // {
  //   question: "",
  //   options: ["","","",""],
  //   answer: 0,
  //   explanation: ""
  // },
];

// ...

var totalQuestions = 3; // Set the number of total questions the player will play
var shuffledQuestions = shuffleArray(questions.slice(0, totalQuestions)); // Shuffle the questions array and select the first 20 questions

var currentQuestion = 0;
var timeLeft = 60;
var timer;
var correctAnswers = 0;
var incorrectAnswers = 0;

function shuffleArray(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  while (0 !== currentIndex) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

function startTimer() {
  timer = setInterval(function() {
    timeLeft--;
    updateProgressBar();
    if (timeLeft === 0) {
      clearInterval(timer);
      showResult(false);
    }
  }, 1000);
}

function updateProgressBar() {
  var progressWidth = (1 - timeLeft / 60) * 100;
  document.getElementById("progress").style.width = progressWidth + "%";
  document.getElementById("progress").style.backgroundColor = getColor(progressWidth);
  document.getElementById("progress").textContent = timeLeft + " វិនាទី⌚";
}

function getColor(progressWidth) {
  var hue = ((1 - progressWidth / 100) * 120).toString(10);
  return "hsl(" + hue + ", 100%, 50%)";
}


function showQuestion() {
  document.getElementById("question").textContent = shuffledQuestions[currentQuestion].question;
  var options = document.getElementById("options").getElementsByTagName("button");
  for (var i = 0; i < options.length; i++) {
    options[i].textContent = shuffledQuestions[currentQuestion].options[i];
  }
}

function checkAnswer(option) {
  clearInterval(timer);
  var isCorrect = option === shuffledQuestions[currentQuestion].answer;
  showResult(isCorrect);
}

function showResult(isCorrect) {
  var result = document.getElementById("result");
  var popup = document.getElementById("popup");
  if (isCorrect) {
    result.textContent = "ពូកែមែនទែន!";
    popup.style.backgroundColor = "lightgreen";
    popup.style.display = "block";
    document.getElementById("popup-title").textContent = "ពន្យល់បន្ថែម";
    document.getElementById("popup-text").textContent = shuffledQuestions[currentQuestion].explanation;
    correctAnswers++;
  } else {
    result.textContent = "មិនត្រឹមត្រូវទេ";
    popup.style.backgroundColor = "pink";
    popup.style.display = "block";
    document.getElementById("popup-title").textContent = "ពន្យល់បន្ថែម";
    document.getElementById("popup-text").textContent = shuffledQuestions[currentQuestion].explanation;
    incorrectAnswers++;
  }
}

function closePopup() {
  var popup = document.getElementById("popup");
  popup.style.display = "none";
  currentQuestion++;
  if (currentQuestion < totalQuestions) {
    timeLeft = 60;
    startTimer();
    showQuestion();
  } else {
    endGame();
  }
}

function endGame() {
  document.getElementById("question").textContent = "Quiz completed!";
  document.getElementById("options").style.display = "none";
  document.getElementById("result").textContent = "ប្រវត្តិលេង: ឆ្លើយបានត្រឹមត្រូវ: " + correctAnswers + ", ឆ្លើយមិនត្រឹមត្រូវ: " + incorrectAnswers + ", នៃសំណួរសរុប: " + totalQuestions;
  document.getElementById("result").style.display = "block";
  document.getElementById("progress-bar").style.display = "none";
  document.getElementById("play-again").style.display = "block";

  // Add Facebook share button
  var shareButton = document.createElement("button");
  shareButton.textContent = "Share on Facebook";
  shareButton.addEventListener("click", function() {
    var url = "https://langdyapps.blogspot.com"; //encodeURIComponent(window.location.href);
    var shareUrl = "https://www.facebook.com/sharer/sharer.php?u=" + url;
    window.open(shareUrl, "_blank");
  });

  document.getElementById("share-button-container").appendChild(shareButton);
}

function playAgain() {
  currentQuestion = 0;
  timeLeft = 60;
  correctAnswers = 0;
  incorrectAnswers = 0;
  shuffledQuestions = shuffleArray(questions.slice(0, totalQuestions));
  startTimer();
  showQuestion();
  document.getElementById("play-again").style.display = "none";
  document.getElementById("options").style.display = "block";
  document.getElementById("result").style.display = "block";
  document.getElementById("progress-bar").style.display = "block";
  document.getElementById("question").textContent = shuffledQuestions[currentQuestion].question;
}

startTimer();
showQuestion();